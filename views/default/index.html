{{extend 'layout.html'}}

<div id="st-container-default" class="st-container">

    <!-- content push wrapper -->
    <div class="st-pusher">

        <ul id="default" class="st-content">
            <li class="st-trigger"><a data-effect="st-effect-right-register">Signup</a></li>
		    <li class="st-trigger"><a data-effect="st-effect-right-login">Login</a></li>
		    <li class="st-trigger"><a data-effect="st-effect-right-info">What's sup?</a></li>
        </ul>

        <ul id="register" class="st-menu-right st-effect-right-register">
            {{=form_register.custom.begin}}
            {{if form_register.errors:}}
            <li>{{=form_register.errors}}</li>
            {{pass}}
            {{form_register.custom.widget.username.placeholder = 'CHOOSE USERNAME'}}
            <li>{{=form_register.custom.widget.username}}</li>
            <li id="form_register_password">{{=form_register.custom.widget.password}}</li>
            <li>{{=form_register.custom.submit}}</li>
            {{=form_register.custom.end}}
        </ul>

        <ul id="login" class="st-menu-right st-effect-right-login">
			{{=form_login.custom.begin}}
			{{if form_login.errors:}}
		    <li>{{=form_login.errors}}</li>
		    {{pass}}
			<li>{{=form_login.custom.widget.username}}</li>
			<li id="form_login_password">{{=form_login.custom.widget.password}}</li>
			<li>{{=form_login.custom.submit}}</li>
			{{=form_login.custom.end}}
        </ul>

        <ul id="info" class="st-menu-right st-effect-right-info">
            <!-- TODO: Copy Yo's about page here -->
            <li><a>Nothin' much...</a></li>
            <li><a>what's up with you?</a></li>
            <!--
            <li><a href="{{=URL('default', 'terms')}}">Terms of Use</a></li>
            <li><a href="{{=URL('default', 'privacy')}}">Privacy</a></li>
            <li id="default-info-done"><a>Done</a></li>
            -->
        </ul>

    </div><!-- /st-pusher -->

</div><!-- /st-container -->

<script>

    function processForm(e) {

        e.preventDefault();

        var pushNotification = window.plugins.pushNotification;
        pushNotification.register(app.onPushSuccess, app.onPushFailure,{"senderID":"649293780544","ecb":"app.onNotificationGCM"});

        return false; // Must return false to prevent the default form behavior
    }

    // TODO: There should be a nicer way to do this...
    // var info_done_button = document.getElementById("default-info-done");
    // info_done_button.onclick = function(){
    //     var container = document.getElementById("st-container-default");
    //     classie.remove(container, "st-menu-right-open");
    // };

    var form = document.getElementById("form_registration");

    if (form.attachEvent) {
        form.attachEvent("submit", processForm);
    } else {
        form.addEventListener("submit", processForm);
    }

    TOTAL_LI_CLASSES = 7; //As listed in main.css "li-#" classes

    // TODO: Cleanup...
    var defaultUl = document.getElementById("default");
    var defaultItems = defaultUl.getElementsByTagName("li");
    var j = 0;
    for (var i = 0; i < defaultItems.length; ++i) {
        defaultItems[i].className += " li-" + j;
        if (j < TOTAL_LI_CLASSES - 1) {
            j = ++j;
        } else {
            j = 0;
        }
    }

    // TODO: Cleanup...
    var loginUl = document.getElementById("login");
    var loginItems = loginUl.getElementsByTagName("input");
    var j = 0;
    for (var i = 0; i < loginItems.length; ++i) {
        loginItems[i].className += " li-" + j;
        if (j < TOTAL_LI_CLASSES - 1) {
            j = ++j;
        } else {
            j = 0;
        }
    }

    // TODO: Cleanup...
    var registerUl = document.getElementById("register");
    var registerItems = registerUl.getElementsByTagName("input");
    var j = 0;
    for (var i = 0; i < registerItems.length; ++i) {
        registerItems[i].className += " li-" + j;
        if (j < TOTAL_LI_CLASSES - 1) {
            j = ++j;
        } else {
            j = 0;
        }
    }

    // TODO: Cleanup...
    var infoUl = document.getElementById("info");
    var infoItems = infoUl.getElementsByTagName("li");
    var j = 0;
    for (var i = 0; i < infoItems.length; ++i) {
        infoItems[i].className += " li-" + j;
        if (j < TOTAL_LI_CLASSES - 1) {
            j = ++j;
        } else {
            j = 0;
        }
    }

</script>