{{extend 'layout.html'}}

<div id="st-container-dashboard" class="st-container">

    <!-- content push wrapper -->
    <div class="st-pusher">

        <ul id="dashboard" class="st-content">
            <li><a>Invite</a></li>
            {{for user in users:}}
            <li>
                <a href="/sup/dashboard/index/{{=user.id}}">
                {{if request.args:}}
                    {{if (user.id == request.args[0]):}}
                        {{=response.flash}}
                    {{else:}}
                        {{=user.username}}
                    {{pass}}
                {{else:}}
                    {{=user.username}}
                {{pass}}
                </a>
            </li>
            {{pass}}
            <li><a>+</a></li>
        </ul>

        <div class="st-trigger">
            <button data-effect="st-effect-bottom">...</button>
        </div>

        <ul id="menu" class="st-menu-bottom st-effect-bottom">
            <li><a>User:{{=auth.user.username}}</a></li>
            <li><a>Invite</a></li>
            <li><a>Unblock</a></li>
            <li><a>Sups: {{=auth.user.sup_count}}</a></li>
            <li><a href="{{=URL('dashboard', 'logout')}}">Log out</a></li>
            <li><a>+</a></li>
            <li id="menu-item-done"><a>Done</a></li>
        </ul>

    </div><!-- /st-pusher -->

</div><!-- /st-container -->

<script type="text/javascript">

    TOTAL_LI_CLASSES = 7; //As listed in main.css "li-#" classes

    // TODO: There should be a nicer way to do this...
    var done_button = document.getElementById("menu-item-done");
    done_button.onclick = function(){
        var container = document.getElementById("st-container-dashboard");
        classie.remove(container, "st-menu-bottom-open");
    };

    // TODO: Cleanup...
    var dashboardUl = document.getElementById("dashboard");
    var dashboardItems = dashboardUl.getElementsByTagName("li");
    var j = 0;
    for (var i = 0; i < dashboardItems.length; ++i) {
        dashboardItems[i].className += " li-" + j;
        if (j < TOTAL_LI_CLASSES - 1) {
            j = ++j;
        } else {
            j = 0;
        }
    }

    // TODO: Cleanup...
    var menuUl = document.getElementById("menu");
    var menuItems = menuUl.getElementsByTagName("li");
    var j = 0;
    for (var i = 0; i < menuItems.length; ++i) {
        menuItems[i].className += " li-" + j;
        if (j < TOTAL_LI_CLASSES - 1) {
            j = ++j;
        } else {
            j = 0;
        }
    }

</script>